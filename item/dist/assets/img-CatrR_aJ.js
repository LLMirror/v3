import{_ as T,r as m,H as A,b as s,d as M,o as f,c as y,f as t,h as e,g as o,k as g,l as k,z as q,e as C,F as G,C as K,M as Q,A as U,t as W}from"./index-Dom6VubR.js";import{h as X,U as Y,c as Z,e as ee,f as te}from"./index-AsNyoiPZ.js";import{U as ae}from"./UsePagination-DJeUD4p2.js";const le={class:"app-container table-height-auto"},ne={class:"img-box"},oe={class:"flex-box"},ie={class:"dialog-footer"},se={__name:"img",setup(re){const{initData:V,dataList:N,pageSearch:R,total:x,pageConfig:_,tableLoading:$,pageRefresh:b}=ae(),{proxy:r}=W(),z=m([{label:"编号",prop:"id",type:"FormInput",placeholder:"请输入编号"}]),i=m(!1),h=m(!1),c=m([]),F=m(null);let d;function I(){i.value=!0,d=void 0,c.value=[]}function O(a){i.value=!0,d=a.id,c.value=E(a)}async function D(){const a=F.value.getFileRes();if(a.length===0)return r.$modal.msgError("请上传图片！！！");try{h.value=!0,!d&&await Z({type:1,val:JSON.stringify(a)}),d&&await ee({id:d,val:JSON.stringify(a)}),b(),r.$modal.msgSuccess(d?"修改成功":"新增成功"),i.value=!1}finally{h.value=!1}}async function j(a){await r.$modal.confirm("确认删除当前图片数据吗？"),await te({id:a.id}),b(),r.$modal.msgSuccess("删除成功")}function B(a){try{return JSON.parse(a.val)}catch{return[]}}function E(a){try{return JSON.parse(a.val).map(w=>w.url).join(",")}catch{return""}}return A(()=>{V(X)}),(a,l)=>{const w=s("FormScreen"),p=s("el-button"),v=s("el-table-column"),J=s("el-image"),L=s("el-table"),P=s("pagination"),H=s("el-dialog"),S=M("loading");return f(),y("div",le,[t(w,{options:e(z),onSearch:e(R)},null,8,["options","onSearch"]),t(p,{type:"primary",plain:"",icon:"Plus",onClick:I,class:"mb10"},{default:o(()=>[g("新增图片")]),_:1}),k((f(),q(L,{data:e(N)},{default:o(()=>[t(v,{label:"编号",align:"center",prop:"id",width:"100"}),t(v,{label:"图片",align:"center",prop:"dictSort"},{default:o(n=>[C("div",ne,[(f(!0),y(G,null,K(B(n.row),u=>(f(),y("div",{key:u.id},[t(J,{style:{width:"100px",height:"100px"},src:e(r).fileHost+u.url,"preview-src-list":[e(r).fileHost+u.url],fit:"cover","preview-teleported":!0},null,8,["src","preview-src-list"])]))),128))])]),_:1}),t(v,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),t(v,{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},{default:o(n=>[t(p,{link:"",size:"small",type:"primary",icon:"Edit",onClick:u=>O(n.row)},{default:o(()=>[g("修改")]),_:2},1032,["onClick"]),t(p,{link:"",size:"small",type:"danger",icon:"Delete",onClick:u=>j(n.row)},{default:o(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[S,e($)]]),k(t(P,{total:e(x),page:e(_).page,"onUpdate:page":l[0]||(l[0]=n=>e(_).page=n),limit:e(_).size,"onUpdate:limit":l[1]||(l[1]=n=>e(_).size=n),onPagination:e(b)},null,8,["total","page","limit","onPagination"]),[[Q,e(x)>0]]),t(H,{title:"图片上传",modelValue:e(i),"onUpdate:modelValue":l[4]||(l[4]=n=>U(i)?i.value=n:null),width:"665px","append-to-body":""},{footer:o(()=>[C("div",oe,[t(Y,{ref_key:"upFileRef",ref:F,modelValue:e(c),"onUpdate:modelValue":l[2]||(l[2]=n=>U(c)?c.value=n:null),runType:"arrayObj",multiple:"",limit:3,size:1,accept:".jpg,.png,.gif,.jpeg,.webp"},null,8,["modelValue"])]),k((f(),y("div",ie,[t(p,{onClick:l[3]||(l[3]=n=>i.value=!1)},{default:o(()=>[g("取 消")]),_:1}),t(p,{type:"primary",onClick:D},{default:o(()=>[g("保 存")]),_:1})])),[[S,e(h)]])]),_:1},8,["modelValue"])])}}},ue=T(se,[["__scopeId","data-v-3e09aa48"]]);export{ue as default};
