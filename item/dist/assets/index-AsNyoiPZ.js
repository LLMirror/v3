import{cs as U,o as E,c as j,e as R,B as Ce,_ as Pe,S as Me,u as Ie,a as je,r as M,v as ge,ct as Le,w as ze,b as W,f as re,b5 as _e,g as N,O as H,x as ae,F as He,z as ie,k as $e,h as ye,E as Ve,t as We,aF as be,K as Ne,Q as Ge,p as Xe,n as Ye}from"./index-Dom6VubR.js";function It(e){return U({url:"/components/addFile",data:e})}function jt(e){return U({url:"/components/getImg",data:e})}function Lt(e){return U({url:"/components/getFile",data:e})}function zt(e){return U({url:"/components/upFile",data:e})}function _t(e){return U({url:"/components/delFile",data:e})}function Ht(e){return U({url:"/components/addDitor",data:e})}function $t(e){return U({url:"/components/getDitor",data:e})}function Vt(e){return U({url:"/components/upDitor",data:e})}function Wt(e){return U({url:"/components/delDitor",data:e})}function Nt(e){return U({url:"/components/addFileMenu",data:e})}function Gt(e){return U({url:"/components/getFileMenu",data:e})}function Xt(e){return U({url:"/components/upFileMenu",data:e})}function Yt(e){return U({url:"/components/delFileMenu",data:e})}function qt(e){return U({url:"/components/getFileBox",data:e})}function Kt(e){return U({url:"/components/addFileBox",data:e})}function Jt(e){return U({url:"/components/delFileBox",data:e})}/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function we(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?we(Object(a),!0).forEach(function(r){Je(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):we(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ee(r.key),r)}}function Ke(e,t,a){return t&&xe(e.prototype,t),a&&xe(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Je(e,t,a){return t=Ee(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},K.apply(this,arguments)}function Qe(e,t){if(typeof e!="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ee(e){var t=Qe(e,"string");return typeof t=="symbol"?t:String(t)}var Re={exports:{}};(function(e){typeof window>"u"||function(t){var a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,r=t.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=r&&t.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,c=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,u=(r||n)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(l){var s,m,f,w,v,o,x,b,A;if(s=l.match(c),!s)throw new Error("invalid data URI");for(m=s[2]?s[1]:"text/plain"+(s[3]||";charset=US-ASCII"),f=!!s[4],w=l.slice(s[0].length),f?v=atob(w):v=decodeURIComponent(w),o=new ArrayBuffer(v.length),x=new Uint8Array(o),b=0;b<v.length;b+=1)x[b]=v.charCodeAt(b);return r?new Blob([i?x:o],{type:m}):(A=new n,A.append(o),A.getBlob(m))};t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(l,s,m){var f=this;setTimeout(function(){m&&a.toDataURL&&u?l(u(f.toDataURL(s,m))):l(f.mozGetAsFile("blob",s))})}:a.toDataURL&&u&&(a.msToBlob?a.toBlob=function(l,s,m){var f=this;setTimeout(function(){(s&&s!=="image/png"||m)&&a.toDataURL&&u?l(u(f.toDataURL(s,m))):l(f.msToBlob(s))})}:a.toBlob=function(l,s,m){var f=this;setTimeout(function(){l(u(f.toDataURL(s,m)))})})),e.exports?e.exports=u:t.dataURLtoBlob=u}(window)})(Re);var Be=Re.exports,Ze=function(t){return typeof Blob>"u"?!1:t instanceof Blob||Object.prototype.toString.call(t)==="[object Blob]"},Fe={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},et=typeof window<"u"&&typeof window.document<"u",k=et?window:{},J=function(t){return t>0&&t<1/0},tt=Array.prototype.slice;function le(e){return Array.from?Array.from(e):tt.call(e)}var rt=/^image\/.+$/;function oe(e){return rt.test(e)}function at(e){var t=oe(e)?e.substr(6):"";return t==="jpeg"&&(t="jpg"),".".concat(t)}var Ae=String.fromCharCode;function it(e,t,a){var r="",i;for(a+=t,i=t;i<a;i+=1)r+=Ae(e.getUint8(i));return r}var nt=k.btoa;function Ue(e,t){for(var a=[],r=8192,i=new Uint8Array(e);i.length>0;)a.push(Ae.apply(null,le(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(t,";base64,").concat(nt(a.join("")))}function ot(e){var t=new DataView(e),a;try{var r,i,n;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var c=t.byteLength,u=2;u+1<c;){if(t.getUint8(u)===255&&t.getUint8(u+1)===225){i=u;break}u+=1}if(i){var l=i+4,s=i+10;if(it(t,l,4)==="Exif"){var m=t.getUint16(s);if(r=m===18761,(r||m===19789)&&t.getUint16(s+2,r)===42){var f=t.getUint32(s+4,r);f>=8&&(n=s+f)}}}if(n){var w=t.getUint16(n,r),v,o;for(o=0;o<w;o+=1)if(v=n+o*12+2,t.getUint16(v,r)===274){v+=8,a=t.getUint16(v,r),t.setUint16(v,1,r);break}}}catch{a=1}return a}function lt(e){var t=0,a=1,r=1;switch(e){case 2:a=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90,r=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:r}}var st=/\.\d*(?:0|9){12}\d*$/;function Te(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return st.test(e)?Math.round(e*t)/t:e}function G(e){var t=e.aspectRatio,a=e.height,r=e.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=J(r),c=J(a);if(n&&c){var u=a*t;(i==="contain"||i==="none")&&u>r||i==="cover"&&u<r?a=r/t:r=a*t}else n?a=r/t:c&&(r=a*t);return{width:r,height:a}}function ut(e){for(var t=le(new Uint8Array(e)),a=t.length,r=[],i=0;i+3<a;){var n=t[i],c=t[i+1];if(n===255&&c===218)break;if(n===255&&c===216)i+=2;else{var u=t[i+2]*256+t[i+3],l=i+u+2,s=t.slice(i,l);r.push(s),i=l}}return r.reduce(function(m,f){return f[0]===255&&f[1]===225?m.concat(f):m},[])}function ct(e,t){var a=le(new Uint8Array(e));if(a[2]!==255||a[3]!==224)return e;var r=a[4]*256+a[5],i=[255,216].concat(t,a.slice(4+r));return new Uint8Array(i)}var ft=k.ArrayBuffer,ne=k.FileReader,I=k.URL||k.webkitURL,dt=/\.\w+$/,ht=k.Compressor,mt=function(){function e(t,a){qe(this,e),this.file=t,this.exif=[],this.image=new Image,this.options=q(q({},Fe),a),this.aborted=!1,this.result=null,this.init()}return Ke(e,[{key:"init",value:function(){var a=this,r=this.file,i=this.options;if(!Ze(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=r.type;if(!oe(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!I||!ne){this.fail(new Error("The current browser does not support image compression."));return}ft||(i.checkOrientation=!1,i.retainExif=!1);var c=n==="image/jpeg",u=c&&i.checkOrientation,l=c&&i.retainExif;if(I&&!u&&!l)this.load({url:I.createObjectURL(r)});else{var s=new ne;this.reader=s,s.onload=function(m){var f=m.target,w=f.result,v={},o=1;u&&(o=ot(w),o>1&&K(v,lt(o))),l&&(a.exif=ut(w)),u||l?!I||o>1?v.url=Ue(w,n):v.url=I.createObjectURL(r):v.url=w,a.load(v)},s.onabort=function(){a.fail(new Error("Aborted to read the image with FileReader."))},s.onerror=function(){a.fail(new Error("Failed to read the image with FileReader."))},s.onloadend=function(){a.reader=null},u||l?s.readAsArrayBuffer(r):s.readAsDataURL(r)}}},{key:"load",value:function(a){var r=this,i=this.file,n=this.image;n.onload=function(){r.draw(q(q({},a),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){r.fail(new Error("Aborted to load the image."))},n.onerror=function(){r.fail(new Error("Failed to load the image."))},k.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(k.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=a.url}},{key:"draw",value:function(a){var r=this,i=a.naturalWidth,n=a.naturalHeight,c=a.rotate,u=c===void 0?0:c,l=a.scaleX,s=l===void 0?1:l,m=a.scaleY,f=m===void 0?1:m,w=this.file,v=this.image,o=this.options,x=document.createElement("canvas"),b=x.getContext("2d"),A=Math.abs(u)%180===90,L=(o.resize==="contain"||o.resize==="cover")&&J(o.width)&&J(o.height),O=Math.max(o.maxWidth,0)||1/0,S=Math.max(o.maxHeight,0)||1/0,C=Math.max(o.minWidth,0)||0,P=Math.max(o.minHeight,0)||0,D=i/n,B=o.width,F=o.height;if(A){var X=[S,O];O=X[0],S=X[1];var g=[P,C];C=g[0],P=g[1];var h=[F,B];B=h[0],F=h[1]}L&&(D=B/F);var d=G({aspectRatio:D,width:O,height:S},"contain");O=d.width,S=d.height;var y=G({aspectRatio:D,width:C,height:P},"cover");if(C=y.width,P=y.height,L){var p=G({aspectRatio:D,width:B,height:F},o.resize);B=p.width,F=p.height}else{var T=G({aspectRatio:D,width:B,height:F}),Y=T.width;B=Y===void 0?i:Y;var z=T.height;F=z===void 0?n:z}B=Math.floor(Te(Math.min(Math.max(B,C),O))),F=Math.floor(Te(Math.min(Math.max(F,P),S)));var Oe=-B/2,De=-F/2,ke=B,Se=F,Q=[];if(L){var se=0,ue=0,Z=i,ee=n,ce=G({aspectRatio:D,width:i,height:n},{contain:"cover",cover:"contain"}[o.resize]);Z=ce.width,ee=ce.height,se=(i-Z)/2,ue=(n-ee)/2,Q.push(se,ue,Z,ee)}if(Q.push(Oe,De,ke,Se),A){var fe=[F,B];B=fe[0],F=fe[1]}x.width=B,x.height=F,oe(o.mimeType)||(o.mimeType=w.type);var de="transparent";w.size>o.convertSize&&o.convertTypes.indexOf(o.mimeType)>=0&&(o.mimeType="image/jpeg");var he=o.mimeType==="image/jpeg";if(he&&(de="#fff"),b.fillStyle=de,b.fillRect(0,0,B,F),o.beforeDraw&&o.beforeDraw.call(this,b,x),!this.aborted&&(b.save(),b.translate(B/2,F/2),b.rotate(u*Math.PI/180),b.scale(s,f),b.drawImage.apply(b,[v].concat(Q)),b.restore(),o.drew&&o.drew.call(this,b,x),!this.aborted)){var me=function($){if(!r.aborted){var ve=function(V){return r.done({naturalWidth:i,naturalHeight:n,result:V})};if($&&he&&o.retainExif&&r.exif&&r.exif.length>0){var pe=function(V){return ve(Be(Ue(ct(V,r.exif),o.mimeType)))};if($.arrayBuffer)$.arrayBuffer().then(pe).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var _=new ne;r.reader=_,_.onload=function(te){var V=te.target;pe(V.result)},_.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},_.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},_.onloadend=function(){r.reader=null},_.readAsArrayBuffer($)}}else ve($)}};x.toBlob?x.toBlob(me,o.mimeType,o.quality):me(Be(x.toDataURL(o.mimeType,o.quality)))}}},{key:"done",value:function(a){var r=a.naturalWidth,i=a.naturalHeight,n=a.result,c=this.file,u=this.image,l=this.options;if(I&&u.src.indexOf("blob:")===0&&I.revokeObjectURL(u.src),n)if(l.strict&&!l.retainExif&&n.size>c.size&&l.mimeType===c.type&&!(l.width>r||l.height>i||l.minWidth>r||l.minHeight>i||l.maxWidth<r||l.maxHeight<i))n=c;else{var s=new Date;n.lastModified=s.getTime(),n.lastModifiedDate=s,n.name=c.name,n.name&&n.type!==c.type&&(n.name=n.name.replace(dt,at(n.type)))}else n=c;this.result=n,l.success&&l.success.call(this,n)}},{key:"fail",value:function(a){var r=this.options;if(r.error)r.error.call(this,a);else throw a}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=ht,e}},{key:"setDefaults",value:function(a){K(Fe,a)}}]),e}();const vt=["src"],pt=["src"],gt=["src"],yt=["src"],bt=["src"],wt=["src"],xt=["src"],Bt=["src"],Ft={__name:"VideoView",props:{url:String,videoStyle:{type:String,default:"width:100%;height:100%;"}},setup(e){return(t,a)=>(E(),j("video",{controls:"",style:Ce(e.videoStyle)},[R("source",{src:e.url,type:"video/mp4"},null,8,vt),R("source",{src:e.url,type:"video/webm"},null,8,pt),R("source",{src:e.url,type:"video/ogg"},null,8,gt),R("source",{src:e.url,type:"video/AVI"},null,8,yt),R("source",{src:e.url,type:"video/FLV"},null,8,bt),R("source",{src:e.url,type:"video/MOV"},null,8,wt),R("source",{src:e.url,type:"video/wmv"},null,8,xt),R("source",{src:e.url,type:"video/mkv"},null,8,Bt)],4))}},Ut=e=>(Xe("data-v-0ed33b2c"),e=e(),Ye(),e),Tt={class:"file-box"},Et={key:0,class:"el-upload__text"},Rt=Ut(()=>R("em",null,"支持拖拽上传",-1)),At=[Rt],Ot={key:1,class:"el-upload__tip",slot:"tip"},Dt={key:2,class:"el-upload__tip",slot:"tip"},kt=["src"],St=Ve({name:"UpFile"}),Ct=Object.assign(St,{props:{modelValue:[String,Array],runType:{type:String,default:"string"},limit:{type:Number,default:0},multiple:{type:Boolean,default:!1},drag:{type:Boolean,default:!1},listType:{default:"picture-card"},accept:{type:String,default:""},size:{type:Number,default:0},disabled:{type:Boolean,default:!1},isClearFiles:{type:Boolean,default:!1},upData:{type:Object,default:()=>{}},isCompress:{type:Boolean,default:!1},quality:{type:Number,default:.7},fileBtnText:{type:String,default:"点击上传"}},emits:["upSuccess","upRemove"],setup(e,{expose:t,emit:a}){const{proxy:r}=We(),i=Me();Ie();const n=je(),c=e,u=M(0),l=M(""),s=M(!1),m="https://xn--2br465g.com//file/file",f=M([]),w=M([]),v=M(null),o=M(!0),x=a,b=ge(()=>({token:Le()})),A=ge(()=>Object.assign({},c.upData));ze(()=>c.modelValue,g=>{if(g){const h=Array.isArray(g)?g:g.split(",");f.value=w.value=h.map(d=>(typeof d=="string"?d={url:r.fileHost+d,name:d}:d={url:r.fileHost+d.url,name:d.name},d))}else f.value=w.value=[];u.value=f.value.length},{deep:!0,immediate:!0});function L(){Ne(()=>{x("update:modelValue",O(f.value))})}function O(g,h){const d=Ge(g);switch(c.runType){case"string":let y="";h=h||",";for(let p in d)d[p].url!==void 0&&d[p].url.indexOf("blob:")!==0&&(y+=d[p].url.replace(r.fileHost,"")+h);return y!=""?y.substr(0,y.length-1):"";case"arrayStr":return d.map(p=>p.url.replace(r.fileHost,""));case"arrayObj":return g.map(p=>(p.url=p.url.replace(r.fileHost,""),p));default:return""}}function S(){return O(f.value)}function C(g){const{url:h,response:d}=g;if(be(h)===1)o.value=!0,l.value=h||d.data[0].url;else if(be(h)===2)o.value=!1,l.value=d?d.data[0].url:h;else return window.open(d?d.data[0].url:h);s.value=!0}function P(g){let{data:h,code:d,msg:y}=g;if(d==203){r.$modal.msgError("登陆失效，请重新登陆！"),i.logOut().then(()=>{n.push({path:"/login"})}),u.value--;return}if(d!=1)return u.value--,r.$modal.msgError(y||"上传失败！");f.value=f.value.concat(h),x("upSuccess",{data:h}),u.value>0&&f.value.length===u.value&&(u.value=0,L(),x("uploadSuccessImgAdmin",f.value),c.isClearFiles&&(f.value=[],setTimeout(()=>{r.$refs.upImg.clearFiles()},500)))}function D(g){let{response:h,status:d}=g,y=h?h.data:[g];const p=y.map(T=>T.url);return f.value=f.value.filter(T=>!p.includes(T.url)),d==="success"&&u.value--,L(),x("upRemove",{data:y})}async function B(g){const h=y=>new Promise(p=>{new mt(y,{quality:c.quality,width:500,height:500,success(T){p(T)},error(){p(y)}})});let d=g;try{c.isCompress&&(d=await h(g))}catch(y){console.log("文件压缩错误",y)}if(c.size&&d.size/1024/1024>c.size)return r.$modal.msgError(`最大不超过${c.size} M`),!1;if(c.accept){const y=/\.([^.]*)$/,p=d.name.match(y),T=p?p[0]:"";if(!c.accept.toLowerCase().includes(T.toLowerCase()))return r.$modal.msgError(`只能上传类型：${c.accept}`),!1}return u.value++,d}function F(){r.$modal.msgError(`一次性最多可上传：${c.limit}个`)}function X(){f.value=[],v.value.clearFiles()}return t({getFileRes:S,clearFiles:X}),(g,h)=>{const d=W("Plus"),y=W("el-icon"),p=W("el-button"),T=W("el-upload"),Y=W("el-dialog");return E(),j("div",Tt,[re(T,{action:m,"list-type":e.listType,multiple:e.multiple,ref_key:"upImg",ref:v,limit:e.limit,"file-list":w.value,"onUpdate:fileList":h[0]||(h[0]=z=>w.value=z),headers:ye(b),drag:e.drag,accept:e.accept,"on-success":P,"on-remove":D,"before-upload":B,"on-exceed":F,"on-preview":C,disabled:e.disabled,data:ye(A)},_e({default:N(()=>[e.disabled?H("",!0):(E(),j(He,{key:0},[e.listType==="picture-card"?(E(),ie(y,{key:0},{default:N(()=>[re(d)]),_:1})):(E(),ie(p,{key:1,size:"small",type:"primary",plain:"",style:{"margin-top":"5px"}},{default:N(()=>[$e(ae(e.fileBtnText),1)]),_:1}))],64))]),_:2},[e.disabled?void 0:{name:"tip",fn:N(()=>[e.drag?(E(),j("div",Et,At)):H("",!0),e.accept?(E(),j("div",Ot,"上传类型："+ae(e.accept),1)):H("",!0),e.size?(E(),j("div",Dt,"最大不超过："+ae(e.size)+" M",1)):H("",!0)]),key:"0"}]),1032,["list-type","multiple","limit","file-list","headers","drag","accept","disabled","data"]),re(Y,{modelValue:s.value,"onUpdate:modelValue":h[1]||(h[1]=z=>s.value=z),size:"tiny","append-to-body":"",width:"50%"},{default:N(()=>[o.value?(E(),j("img",{key:0,style:{width:"100%"},src:l.value,alt:"预览"},null,8,kt)):H("",!0),s.value&&!o.value?(E(),ie(Ft,{key:1,url:l.value,videoStyle:"width: 100%;height: 100%"},null,8,["url"])):H("",!0)]),_:1},8,["modelValue"])])}}}),Qt=Pe(Ct,[["__scopeId","data-v-0ed33b2c"]]);export{Qt as U,Ft as _,Ht as a,Lt as b,It as c,Wt as d,zt as e,_t as f,$t as g,jt as h,Xt as i,Nt as j,Yt as k,Kt as l,Jt as m,Gt as n,qt as o,Vt as u};
