import{S as ce,u as me,r as d,ct as fe,H as Z,b as a,d as ee,o as v,z as A,g as t,l as x,c as L,f as e,k as n,h as l,e as Q,O as Y,x as _e,A as te,t as le,_ as ge,N as ye,X as ve,M as be,aB as he}from"./index-Dom6VubR.js";import{g as we,d as ke,u as xe,a as Te,b as Ve,e as Pe}from"./index-C3WqVBfQ.js";import{U as Fe}from"./UsePagination-DJeUD4p2.js";const Ce=Q("div",{class:"el-upload__text"},[n(" 将文件拖到此处，或 "),Q("em",null,"点击上传")],-1),Se={class:"el-upload__tip",slot:"tip",style:{"text-align":"right"}},Re={key:0,class:"el-upload__tip",style:{color:"red"},slot:"tip"},$e={class:"dialog-footer"},Ue={__name:"index",props:{limit:{type:Number,default:1},accept:{type:String,default:".xlsx,.xls"},url:{type:String,default:""},showTemplate:{type:Boolean,default:!0},sign:{type:Boolean,default:!1},parentParams:{type:Object,default:()=>({})},downloadApi:{type:Function,default:async()=>{}}},emits:["downloadTemplate","importRes"],setup(b,{expose:c,emit:B}){const{proxy:T}=le(),C=ce(),S=me(),g=b,m=d(!1),p=d(!1),V=d(!1),f={Token:fe()},_=d(""),w=d(null),P=d({name:"导入文件"}),s=B;function E(){m.value=!0}async function N(){V.value=!0;const u=await g.downloadApi();T.downFile(u),setTimeout(()=>{V.value=!1},1500)}function R(){m.value=!1,p.value=!1}function O(u,y,F){p.value=!0}function M(u,y,F){if(p.value=!1,w.value.clearFiles(),u.code==203){T.$modal.msgError("登陆失效，请重新登陆！"),C.logOut().then(()=>{try{location.href=S.fullPath||"/index"}catch{location.href="/index"}});return}if(u.code!==1)return T.$modal.msgError(u.msg||"导入失败！");m.value=!1,s("importRes",u)}function q(){P.value={...P.value,...g.parentParams},w.value.submit()}return c({show:E}),Z(()=>{_.value="https://xn--2br465g.com/"+g.url}),(u,y)=>{const F=a("Plus"),$=a("el-icon"),j=a("el-link"),H=a("el-upload"),U=a("el-button"),W=a("el-dialog"),I=ee("loading");return v(),A(W,{title:"文件上传",modelValue:l(m),"onUpdate:modelValue":y[1]||(y[1]=D=>te(m)?m.value=D:null),width:"400px","append-to-body":"","close-on-click-modal":!1},{footer:t(()=>[x((v(),L("div",$e,[e(U,{onClick:y[0]||(y[0]=D=>m.value=!1)},{default:t(()=>[n("取 消")]),_:1}),e(U,{type:"primary",onClick:q},{default:t(()=>[n("确 定")]),_:1})])),[[I,l(p)]])]),default:t(()=>[e(H,{ref_key:"uploadRef",ref:w,limit:b.limit,accept:b.accept,headers:f,action:l(_),data:l(P),"on-progress":O,"on-success":M,"on-error":R,"auto-upload":!1,drag:"",disabled:l(p)},{tip:t(()=>[Q("div",Se,[b.showTemplate?x((v(),A(j,{key:0,type:"primary",onClick:N},{default:t(()=>[n("下载模板")]),_:1})),[[I,l(V)]]):Y("",!0)]),b.accept?(v(),L("div",Re," 提示：仅允许导入"+_e(b.accept)+"格式文件！ ",1)):Y("",!0)]),default:t(()=>[e($,null,{default:t(()=>[e(F)]),_:1}),Ce]),_:1},8,["limit","accept","action","data","disabled"])]),_:1},8,["modelValue"])}}},Ie={class:"app-container table-height-auto"},De={class:"dialog-footer"},ze={__name:"index",setup(b){const{proxy:c}=le(),{initData:B,dataList:T,dataParams:C,total:S,pageConfig:g,tableLoading:m,pageRefresh:p,pageSearch:V}=Fe(),f=d(!1),_=d(!1),w=d(null),P=ye({form:{},queryParams:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]}}),{form:s,rules:E,queryParams:N}=ve(P),R=d([]),O=d([{label:"单选测试1",value:1},{label:"单选测试2",value:2}]),M=d([{name:"多选测试1",ids:1},{name:"多选测试2",ids:2}]),q=d([{label:"测试账号名称",type:"FormInput",prop:"name",placeholder:"请输入测试名称"},{label:"单选选择器",type:"FormSelect",prop:"select",options:O.value,placeholder:"请选择 单选选择器"},{label:"多选选择器",type:"FormSelect",prop:"multiples",options:M.value,placeholder:"请选择 多选选择器",keyValue:"ids",keyLabel:"name",formItemWidth:"400px",modelValue:[],multiple:!0,clearable:!1},{label:"单个日期",type:"FormDate",prop:"date1",placeholder:"请选择 单个日期",modelValue:"2025-01-23",valTime:!0},{label:"范围日期",type:"FormDate",dateType:"daterange",prop:"date2",startPlaceholder:"开始日期",endPlaceholder:"结束日期",modelValue:["2025-01-23","2025-01-25"],startProp:"startTime",endProp:"endTime"},{label:"单个日期时间",type:"FormDate",dateType:"datetime",prop:"date3",placeholder:"请选择 单个日期时间"},{label:"范围日期时间",type:"FormDate",dateType:"datetimerange",prop:"date4",placeholder:"请选择日期时间",startPlaceholder:"开始日期时间",endPlaceholder:"结束日期时间",startProp:"startTime2",endProp:"endTime2"},{label:"我是禁用的",type:"FormInput",prop:"disabled",placeholder:"我是禁用的",disabled:!0},{label:"我是插槽自定义",prop:"slot1"}]);function u(){f.value=!0,s.value={}}async function y(){try{await c.$refs.formRef.validate(),_.value=!0,s.value.id&&await xe(s.value),!s.value.id&&await Te(s.value),f.value=!1,c.$modal.msgSuccess(s.value.id?"修改成功":"新增成功"),p()}finally{_.value=!1}}function F(r){f.value=!0,s.value={...r}}async function $(r){await c.$modal.confirm(`是否确定删除数据：${r.name||""}？`),await Ve({id:r.id}),c.$modal.msgSuccess("删除成功"),p()}function j(){w.value.show()}function H(){c.$modal.msgSuccess("导入成功！"),p()}async function U(){await c.$modal.confirm("确认导出数据项吗？");try{_.value=!0;const r=await Pe(N.value);c.downFile(r)}finally{_.value=!1}}async function W(){const{data:r}=await he();R.value=r}const I=()=>{console.log("点击了重置按钮")},D=r=>{console.log("选择器change事件监听",r)},ae=r=>{console.log("输入框input事件监听",r)};return Z(()=>{B(we),W()}),(r,i)=>{const z=a("el-text"),X=a("el-input"),G=a("el-form-item"),oe=a("FormScreen"),h=a("el-button"),J=a("el-col"),ne=a("el-row"),k=a("el-table-column"),se=a("TagView"),ie=a("el-table"),re=a("pagination"),de=a("el-form"),pe=a("el-dialog"),K=ee("loading");return v(),L("div",Ie,[e(z,{style:{"margin-bottom":"10px",display:"inline-block"},size:"large",type:"primary"},{default:t(()=>[n("当前展示全局组件FormScreen，测试账号名的输入框搜索可联动下方数据，其他为展示案例。常用的筛选可直接使用此组件，通过options配置即可"),e(z,{type:"danger",size:"large"},{default:t(()=>[n("（组件默认配合分页的”UsePagination“使用，会自动传入参数。若不是配合”UsePagination“使用，也可通过@search获取对应的筛选参数）")]),_:1})]),_:1}),e(oe,{options:l(q),onSearch:l(V),onReset:I,onChange:D,onInput:ae},{slot1:t(()=>[e(G,{label:"插槽自定义"},{default:t(()=>[e(X,{modelValue:l(C).slot1,"onUpdate:modelValue":i[0]||(i[0]=o=>l(C).slot1=o),placeholder:"插槽自定义的组件"},null,8,["modelValue"])]),_:1})]),_:1},8,["options","onSearch"]),e(z,{style:{margin:"20px 0 10px",display:"inline-block"},size:"large",type:"primary"},{default:t(()=>[n("多账号理解：通过每个用户可分配不同账号归属来区分，如果你现在属于”账号1“的用户，那你新增的数据只能给属于”账号1“的用户们管理。不属于同个账号归属是看不见对方数据的。"),e(z,{type:"danger",size:"large"},{default:t(()=>[n("（admin总管理没有账号归属说法。演示需要 默认《第一家店铺》）")]),_:1})]),_:1}),e(ne,{class:"mb10",gutter:10},{default:t(()=>[e(J,{span:1.5},{default:t(()=>[e(h,{type:"primary",plain:"",icon:"Plus",onClick:u},{default:t(()=>[n("新增")]),_:1})]),_:1}),e(J,{span:1.5},{default:t(()=>[e(h,{type:"info",plain:"",icon:"Download",onClick:j},{default:t(()=>[n("导入")]),_:1})]),_:1}),x((v(),A(J,{span:1.5},{default:t(()=>[e(h,{type:"success",plain:"",icon:"Upload",onClick:U},{default:t(()=>[n("导出")]),_:1})]),_:1})),[[K,l(_)]])]),_:1}),x((v(),A(ie,{data:l(T)},{default:t(()=>[e(k,{label:"编号",align:"center",prop:"id"}),e(k,{label:"测试账号名称",align:"center",prop:"name","show-overflow-tooltip":!0}),e(k,{label:"归属的多账号",align:"center",prop:"moreId"},{default:t(o=>[e(se,{value:o.row.moreId,options:l(R),keyValue:"id",keyLabel:"name"},null,8,["value","options"])]),_:1}),e(k,{label:"备注",align:"center",prop:"remark","show-overflow-tooltip":!0}),e(k,{label:"创建时间",align:"center",prop:"createTime",width:"180"}),e(k,{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},{default:t(o=>[e(h,{link:"",size:"small",type:"primary",icon:"Edit",onClick:ue=>F(o.row)},{default:t(()=>[n("修改")]),_:2},1032,["onClick"]),e(h,{link:"",size:"small",type:"danger",icon:"Delete",onClick:ue=>$(o.row)},{default:t(()=>[n("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,l(m)]]),x(e(re,{total:l(S),page:l(g).page,"onUpdate:page":i[1]||(i[1]=o=>l(g).page=o),limit:l(g).size,"onUpdate:limit":i[2]||(i[2]=o=>l(g).size=o),onPagination:l(p)},null,8,["total","page","limit","onPagination"]),[[be,l(S)>0]]),e(pe,{title:"测试数据",modelValue:l(f),"onUpdate:modelValue":i[6]||(i[6]=o=>te(f)?f.value=o:null),width:"500px","append-to-body":""},{footer:t(()=>[x((v(),L("div",De,[e(h,{onClick:i[5]||(i[5]=o=>f.value=!1)},{default:t(()=>[n("取 消")]),_:1}),e(h,{type:"primary",onClick:y},{default:t(()=>[n("确 定")]),_:1})])),[[K,l(_)]])]),default:t(()=>[e(de,{ref:"formRef",model:l(s),rules:l(E),"label-width":"120px"},{default:t(()=>[e(G,{label:"测试账号名称",prop:"name"},{default:t(()=>[e(X,{modelValue:l(s).name,"onUpdate:modelValue":i[3]||(i[3]=o=>l(s).name=o),placeholder:"请输入测试账号名称"},null,8,["modelValue"])]),_:1}),e(G,{label:"备注",prop:"remark"},{default:t(()=>[e(X,{modelValue:l(s).remark,"onUpdate:modelValue":i[4]||(i[4]=o=>l(s).remark=o),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(l(Ue),{ref_key:"handleImportRef",ref:w,url:"/tests/importTests",onImportRes:H,downloadApi:l(ke)},null,8,["downloadApi"])])}}},Ee=ge(ze,[["__scopeId","data-v-c3188acb"]]);export{Ee as default};
