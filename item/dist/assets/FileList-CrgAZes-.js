import{_ as ee,r as y,v as te,w as le,aF as k,Q as ie,b as c,o as u,c as p,e as x,h as a,z as f,g as d,f as o,O as b,B as V,k as F,x as D,aG as ae,aH as R,P as C,A as E,F as ne,t as se}from"./index-Dom6VubR.js";import{F as me}from"./index-Cp-ThHdC.js";import{_ as H}from"./index-AsNyoiPZ.js";import{D as oe}from"./vuedraggable.umd-DILWhdXN.js";const ue={class:"img-list"},ce={key:1},de={key:2,class:"no-img"},re=["title"],fe={__name:"FileList",props:{modelValue:[String,Array],runType:{type:String,default:"string"},itemName:{type:String,default:"url"},selectNum:{type:Number,default:0},disabled:{type:Boolean,default:!1},imgStyle:{type:String,default:"width: 100px; height: 100px"},fit:{type:String,default:""},isMore:{type:Boolean,default:!1},hint:{type:String,default:""},sort:{type:Boolean,default:!0},accept:{type:String,default:""},selectAccept:{type:String,default:""},size:{type:Number,default:0},limit:{type:Number,default:0},multiple:{type:Boolean,default:!0},isCompress:{type:Boolean,default:!1},moreFileNum:{type:Number||void 0,default:void 0},isDeleteIcon:{type:Boolean,default:!0},iconSize:{type:Number,default:18},title:{type:String,default:"文件库"},classTitle:{type:String,default:"文件分类"},classAllName:{type:String,default:"全部文件"},fileBtnText:{type:String,default:"点击上传"},msgName:{type:String,default:"文件"}},emits:["update:modelValue","imgAdminRes","draggableEnd"],setup(e,{emit:U}){const s=e,{proxy:v}=se(),N=U,z=y(!1),S=y([]),I=y(0),l=y([]),g=y([]),w=y(!1),A=y(""),L=te(()=>s.selectNum===0?!0:l.value.length<s.selectNum);le(()=>s.modelValue,i=>{if(i){switch(s.runType){case"string":const t=i.split(",");l.value=t.map(n=>({[s.itemName]:n}));break;case"arrayStr":l.value=i.map(n=>({[s.itemName]:n}));break;case"arrayObj":l.value=i.map(n=>({...n,[s.itemName]:n[s.itemName]}));break;default:l.value=i}S.value=l.value.filter(t=>k(t[s.itemName])===1).map(t=>v.fileHost+t[s.itemName]),g.value=ie(l.value)}else return S.value=l.value=[],g.value=[],[]},{deep:!0,immediate:!0});function h(i){switch(s.runType){case"string":return i.map(t=>t[s.itemName]).join(",");case"arrayStr":return i.map(t=>t[s.itemName]);case"arrayObj":return i;default:return""}}function O(i){l.value=l.value.concat(i),S.value=l.value.filter(n=>k(n[s.itemName])===1).map(n=>v.fileHost+n[s.itemName]);const t=h(l.value);N("update:modelValue",t),N("imgAdminRes",t)}function $(){v.$refs.FileIndexRef.showOpen()}function B(i){const t=v.fileHost+i,n=S.value.findIndex(r=>r===t);switch(n>=0&&(I.value=n),k(t)){case 1:z.value=!0;break;case 2:A.value=t,w.value=!0;break;case 3:window.open(t,"_blank");break}}function j(i){l.value.splice(i,1),g.value.splice(i,1),N("update:modelValue",h(l.value))}function M(){l.value=[],g.value=[],N("update:modelValue",h(l.value))}function P(){const i=h(l.value);N("update:modelValue",i),N("draggableEnd",i)}return(i,t)=>{const n=c("Delete"),r=c("el-icon"),Z=c("el-image"),G=c("Document"),Q=c("el-text"),q=c("ZoomIn"),J=c("Download"),K=c("Plus"),W=c("el-link"),X=c("el-image-viewer"),Y=c("el-dialog");return u(),p(ne,null,[x("div",null,[x("div",ue,[!e.disabled&&e.isDeleteIcon&&a(l).length>1?(u(),f(r,{key:0,class:"delete-all",onClick:M,color:"#ce0303",size:e.iconSize,title:"删除全部"},{default:d(()=>[o(n)]),_:1},8,["size"])):b("",!0),o(a(oe),{list:a(l),"force-fallback":!0,sort:e.sort,"item-key":"url",onEnd:P,animation:"300"},{item:d(({element:m,index:_})=>[x("div",{class:"img-item",style:V(e.imgStyle)},[a(k)(m[e.itemName])===1?(u(),f(Z,{key:0,style:V(e.imgStyle),src:a(v).fileHost+m[e.itemName],fit:e.fit,"preview-teleported":!0},null,8,["style","src","fit"])):a(k)(m[e.itemName])===2?(u(),p("div",ce,[o(H,{videoStyle:e.imgStyle,url:a(v).fileHost+m[e.itemName]},null,8,["videoStyle","url"])])):(u(),p("div",de,[x("div",null,[o(r,{size:"20"},{default:d(()=>[o(G)]),_:1})]),o(Q,{type:"primary"},{default:d(()=>[F(D(a(ae)(a(R)(m[e.itemName]))),1)]),_:2},1024)])),x("div",{class:C(["img-item-icon",a(l).length>1?"icon-move":""]),title:a(R)(m[e.itemName])},[a(k)(m[e.itemName])!==3?(u(),f(r,{key:0,onClick:T=>B(m[e.itemName]),color:"#fff",size:e.iconSize,title:"放大",class:C(["img-item-icon-view",{"img-item-icon-view-mr":e.disabled}]),style:{cursor:"pointer"}},{default:d(()=>[o(q)]),_:2},1032,["onClick","size","class"])):(u(),f(r,{key:1,onClick:T=>B(m[e.itemName]),size:e.iconSize,title:"下载",color:"#fff",class:C(["img-item-icon-view",{"img-item-icon-view-mr":e.disabled}]),style:{cursor:"pointer"}},{default:d(()=>[o(J)]),_:2},1032,["onClick","size","class"])),e.disabled?b("",!0):(u(),f(r,{key:2,onClick:T=>j(_),color:"#fff",size:e.iconSize,title:"删除",style:{cursor:"pointer"}},{default:d(()=>[o(n)]),_:2},1032,["onClick","size"]))],10,re)],4)]),footer:d(()=>[L.value&&!e.disabled?(u(),p("div",{key:0,onClick:$,class:"add-icon",style:V(e.imgStyle)},[o(r,null,{default:d(()=>[o(K)]),_:1})],4)):b("",!0)]),_:1},8,["list","sort"])]),e.hint?(u(),f(W,{key:0,type:"danger"},{default:d(()=>[F(D(e.hint),1)]),_:1})):b("",!0)]),a(z)?(u(),f(X,{key:0,"initial-index":a(I),"preview-teleported":!0,onClose:t[0]||(t[0]=()=>{z.value=!1}),"url-list":a(S)},null,8,["initial-index","url-list"])):b("",!0),o(a(me),{ref:"FileIndexRef",runType:"arrayObj",modelValue:a(g),"onUpdate:modelValue":t[1]||(t[1]=m=>E(g)?g.value=m:null),selectNum:e.selectNum,isMore:e.isMore,onImgAdminRes:O,accept:e.accept,selectAccept:e.selectAccept,size:e.size,limit:e.limit,multiple:e.multiple,disabled:e.disabled,title:e.title,classTitle:e.classTitle,classAllName:e.classAllName,fileBtnText:e.fileBtnText,moreFileNum:e.moreFileNum,msgName:e.msgName,isCompress:e.isCompress,itemName:e.itemName},null,8,["modelValue","selectNum","isMore","accept","selectAccept","size","limit","multiple","disabled","title","classTitle","classAllName","fileBtnText","moreFileNum","msgName","isCompress","itemName"]),o(Y,{modelValue:a(w),"onUpdate:modelValue":t[2]||(t[2]=m=>E(w)?w.value=m:null),size:"tiny","append-to-body":"",width:"50%"},{default:d(()=>[a(w)?(u(),f(H,{key:0,url:a(A),videoStyle:"width: 100%;height: 700px"},null,8,["url"])):b("",!0)]),_:1},8,["modelValue"])],64)}}},ke=ee(fe,[["__scopeId","data-v-4cb5d6c9"]]);export{ke as F};
